#!/usr/bin/env node


const _ = require('lodash'),
      prefer = require('prefer'),
      Daemon = require('inform-daemon');


function startDaemon(err, preferences) {
  const daemon = new Daemon;

  _.each(preferences.plugins, (pluginSettings, pluginName) => {
    daemon.use("inform-plugin-#{ pluginName }", pluginSettings);
  });

  daemon.listen();
}


function configure(configurator) { configurator.get(startDaemon); }


prefer.load('informd').done(configure);
